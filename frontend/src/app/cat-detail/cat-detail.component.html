<div
  class="md:w-full w-auto md:mx-0 -mx-3 justify-between items-center mb-4 p-3 bg-black/70 rounded-sm"
>
  <div class="flex flex-wrap">
    <div class="md:w-6/12 lg:w-7/12 w-full px-4">
      <div class="space-y-6">
          <h2 class="text-4xl font-normal text-white mb-3">{{ cat?.title }}</h2>
          <p class="text-sm text-stone-400">Aggiunto il {{ this.formatDate(this.cat?.createdAt) }} da {{ cat?.authorUsername }}</p>
        </div>

        <div class="my-4">
          <markdown class="text-stone-200" [data]="cat?.description"></markdown>
        </div>

        <div class="image rounded-sm bg-gray-300 w-full h-[300px] mb-4">
          <img class="w-full h-full object-cover" src="{{ this.image }}">
        </div>
    </div>
    <div class="md:w-6/12 lg:w-5/12 w-full my-2 py-6 px-4">
      <h4 class="text-2xl font-medium text-white mb-3">Posizione</h4>
      <app-map [style]="'w-full h-[300px]'" [mapId]="'catDetailMap'" [cats]="[cat]"></app-map>

      <div class="description mt-6 bg-neutral-800/70 rounded-xl">
        <div class="pt-7 px-5 pb-3">
            <h4 class="text-2xl font-medium text-white mb-3">Commenti</h4>

            <div class="comments-box relative w-full py-5 h-64 overflow-y-scroll">
              @for (comment of this.comments; track comment) {
                <div class="comment mb-4 mr-1">
                  <div class="flex justify-start gap-2 items-center">
                    <p class="font-medium text-white">{{ comment.authorUsername }}</p>
                    <p class="text-stone-400 text-xs">{{ this.formatDate(comment.createdAt) }}</p>
                  </div>
                  <p class="text-stone-100 mt-2 break-all">{{ comment.text }}</p>
                </div>
              } @empty {
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                  <p class="text-stone-400 text-lg italic">Non ci sono ancora commenti</p>
                </div>
              }
            </div>
        </div>
        <div class="py-2 px-5 bg-neutral-800 rounded-b-xl">
          @if (!authService.isUserAuthenticated()) {
            <span class="text-gray-500 italic mr-1">
                Effettua il 
              </span>
              <a routerLink="/signin" class="not-italic relative transition-colors duration-300 cursor-pointer text-white/50 hover:text-white after:absolute after:left-0 after:bottom-0 after:h-[1px] after:w-0 after:bg-white/50 hover:after:bg-white after:transition-all after:duration-300 hover:after:w-full">log in</a>
              <span class="text-gray-500 italic">
                per lasciare un commento
              </span>
          } @else {
            <form [formGroup]="commentForm" (ngSubmit)="handleCommentSubmit()">
              <div class="flex flex-wrap">
                <textarea
                autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"
                #commentBox
                formControlName="text"
                placeholder="Aggiungi un commento..."
                (input)="handleCommentInput(commentBox)"
                class="md:text-base text-sm text-white bg-transparent border-0 resize-none flex-auto
                      overflow-y-auto focus:outline-none leading-tight
                      placeholder-white/50
                      min-h-[20px] max-h-[80px]"></textarea>
                <div class="h-auto flex items-center ml-2">
                    <button #submitComment disabled class="not-disabled:cursor-pointer focus:outline-hidden submit-comment text-white/50 disabled:opacity-50 hover:not-disabled:text-white">Pubblica</button>
                </div>
              </div>
            </form>
          }
        </div>
      </div>
    </div>
  </div>
</div>